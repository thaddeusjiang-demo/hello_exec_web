#!/bin/sh
set -euo pipefail

echo "ğŸš€ Building HelloExecWeb..."

# æ„å»º Swift å¯åŠ¨å™¨
swift build

# è·å–æ„å»ºç›®å½•
target_dir=`swift build --show-bin-path`

# æ„å»ºé™æ€èµ„æº
echo "ğŸ¨ Building assets..."
(cd ../.. && mix assets.build)

# æ„å»º Phoenix åº”ç”¨åˆ°æŒ‡å®šç›®å½•
echo "ğŸ“¦ Building Phoenix release..."
(cd ../.. && mix release --overwrite --path=$target_dir/rel)

echo "ğŸŒ Starting HelloExecWeb..."
echo "ğŸ“± Browser will open automatically at http://localhost:4000"

# è®¾ç½® Phoenix æœåŠ¡å™¨ç¯å¢ƒå˜é‡å¹¶å¯åŠ¨åº”ç”¨
export PHX_SERVER=true
$target_dir/HelloExecWeb
